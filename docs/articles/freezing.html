<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Freezing • fgu.avoidance</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Freezing">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fgu.avoidance</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/area-presence-and-crosses.html">Area presence and crosses</a>
    </li>
    <li>
      <a href="../articles/freezing.html">Freezing</a>
    </li>
    <li>
      <a href="../articles/visualisations.html">Visualisations</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Freezing</h1>
            
      
      
      <div class="hidden name"><code>freezing.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fgu.avoidance)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; Loading required package: navr</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; Loading required package: ggplot2</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 3.6.3</span></a>
<a class="sourceLine" id="cb1-5" title="5">animals &lt;-<span class="st"> </span><span class="kw">load_data</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/file.path">file.path</a></span>(<span class="st">".."</span>, <span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"run"</span>, <span class="st">"three-animals.csv"</span>))</a>
<a class="sourceLine" id="cb1-6" title="6">animal &lt;-<span class="st"> </span>animals<span class="op">$</span>animal_<span class="dv">8</span></a></code></pre></div>
<div id="freezes-search" class="section level2">
<h2 class="hasAnchor">
<a href="#freezes-search" class="anchor"></a>Freezes search</h2>
<p>Firstly we have to look at the speed the animal makes</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">plot_speed</span>(animal)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></a></code></pre></div>
<p><img src="freezing_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>it is evident that the speed kinda jumps around, in some occasions even jumping above 400 units. There are many preprocessing elements which we can do to smooth or fix things up. Please see the package <code>navr</code> for some deeper ideas about speed cleaning and searching for movement stops and onsets. In this vignette, we will only cover the basics</p>
<p>Let’s search for all freezings of at least 2s, which don’t overcome the speed 0.5. The speed above 0 is NECESSARY, because of how the mechanism actually records animal’s position. The device does NOT record consecutively, but only records changes in position. Therefore each two recordings will be from different positions and therefore there will always be some distance traveled and speed above 0.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">freezes &lt;-<span class="st"> </span><span class="kw">collect_freezes</span>(animal, <span class="dt">speed_threshold =</span> <span class="fl">0.5</span>, <span class="dt">min_duration =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(freezes)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; List of 3</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt;  $ time            : num [1:38] 332 520 778 786 822 ...</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt;  $ time_since_start: num [1:38] 332 520 778 786 822 ...</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt;  $ duration        : num [1:38] 38.53 15.9 7.17 24.3 23.75 ...</span></a></code></pre></div>
<p>So we have found 38 instances of animal freezing. Let’s visualise them</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">plot_speed</span>(animal) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">geom_navr_timeseries_events</span>(freezes<span class="op">$</span>time_since_start, <span class="dt">durations =</span> freezes<span class="op">$</span>duration, <span class="dt">color=</span><span class="st">"red"</span>, <span class="dt">size=</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot.window">xlim</a></span>(<span class="dv">1000</span>,<span class="dv">1300</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; Warning: Removed 4012 row(s) containing missing values (geom_path).</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; Warning: Removed 33 rows containing missing values (geom_vline).</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; Warning: Removed 33 rows containing missing values (geom_rect).</span></a></code></pre></div>
<p><img src="freezing_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>We can also plot the positions of the animal during those times of</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">freezes_times &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(freezes<span class="op">$</span>time, freezes<span class="op">$</span>time<span class="op">+</span>freezes<span class="op">$</span>duration)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">plot_path</span>(animal) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw">geom_navr_path_events</span>(animal<span class="op">$</span>position, freezes_times)</a></code></pre></div>
<p><img src="freezing_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="speed-smoothing" class="section level2">
<h2 class="hasAnchor">
<a href="#speed-smoothing" class="anchor"></a>Speed smoothing</h2>
<p>The speed smoothing is optional and unwanted in some situations, but it allows to smooth out some jittery movement in too short times. E.g. if the animal moves 1cm, but because of the recording fault, it moves in 0.001s (say the two recordings were made by erro quite fast one after another), this speed will look like a speed of 10ms/s, although it is just a small step but measured in too short time.</p>
<p>Speed smoothing or position smoothing can solve some of these issues, although it creates potential trouble with smoothing out onsets and potentially removing some freezing period.</p>
<p>The balck line represents the median smoothed value, the blue is the original speed</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">animal_smooothed &lt;-<span class="st"> </span><span class="kw">smooth_speed</span>(animal, <span class="dt">type=</span><span class="st">"median"</span>, <span class="dt">points=</span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; Warning in smooth_vector(obj$data$speed, type, ...): There are NAs in the</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; vector, replacing with last known value</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">plot_speed</span>(animal_smooothed, <span class="dt">size=</span><span class="fl">1.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span><span class="kw">geom_navr_obj_timeseries</span>(animal<span class="op">$</span>position, <span class="st">"speed"</span>, <span class="dt">color=</span><span class="st">"blue"</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot.window">xlim</a></span>(<span class="dv">1000</span>,<span class="dv">1500</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot.window">ylim</a></span>(<span class="dv">0</span>,<span class="dv">200</span>)</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; Warning: Removed 3942 row(s) containing missing values (geom_path).</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; Warning: Removed 3942 row(s) containing missing values (geom_path).</span></a></code></pre></div>
<p><img src="freezing_files/figure-html/unnamed-chunk-6-1.png" width="700"> Because the speeds are smoothed, we need to increase the threshold for the stopping</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">freezes &lt;-<span class="st"> </span><span class="kw">collect_freezes</span>(animal_smooothed, <span class="dt">speed_threshold =</span> <span class="dv">3</span>, <span class="dt">min_duration =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">plot_speed</span>(animal_smooothed) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">geom_navr_timeseries_events</span>(freezes<span class="op">$</span>time_since_start, <span class="dt">durations =</span> freezes<span class="op">$</span>duration, <span class="dt">color=</span><span class="st">"red"</span>, <span class="dt">size=</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="freezing_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="speed-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#speed-selection" class="anchor"></a>Speed selection</h2>
<p>Speed selection for freeze onset is also quite individual, depending on the current paradigm and especially frequency of recording. If the frequency is quite high, we are runnign into trouble with weird peaks, if too low, then we can have long periods of “nothing”.</p>
<p>All in all, the speed needs to be selected per paradigm basis, investigated individually and corrected for potential outliers.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">freezes &lt;-<span class="st"> </span><span class="kw">collect_freezes</span>(animal, <span class="dt">speed_threshold =</span> <span class="fl">0.5</span>, <span class="dt">min_duration =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">freezes_times &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(freezes<span class="op">$</span>time, freezes<span class="op">$</span>time<span class="op">+</span>freezes<span class="op">$</span>duration)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">plot_path</span>(animal) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">  </span><span class="kw">geom_navr_path_events</span>(animal<span class="op">$</span>position, freezes_times)</a></code></pre></div>
<p><img src="freezing_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>If we set the speed limit to 5, we will find much more</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">freezes &lt;-<span class="st"> </span><span class="kw">collect_freezes</span>(animal, <span class="dt">speed_threshold =</span> <span class="dv">5</span>, <span class="dt">min_duration =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">freezes_times &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(freezes<span class="op">$</span>time, freezes<span class="op">$</span>time<span class="op">+</span>freezes<span class="op">$</span>duration)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">plot_path</span>(animal) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">geom_navr_path_events</span>(animal<span class="op">$</span>position, freezes_times)</a></code></pre></div>
<p><img src="freezing_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#freezes-search">Freezes search</a></li>
      <li><a href="#speed-smoothing">Speed smoothing</a></li>
      <li><a href="#speed-selection">Speed selection</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Lukas Hejtmanek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
